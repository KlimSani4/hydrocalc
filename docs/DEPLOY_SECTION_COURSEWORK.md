# Текст для вставки в курсовую работу

## Раздел: Деплоймент бекенда (для замены/дополнения существующего)

---

### 4.3 Развёртывание серверной части приложения

Развёртывание серверной части приложения «HydroCalc» реализовано с использованием современных практик непрерывной интеграции и доставки (CI/CD), а также подхода GitOps для управления инфраструктурой.

#### 4.3.1 Контейнеризация приложения

Для обеспечения единообразия среды выполнения и упрощения процесса развёртывания все серверные компоненты приложения упакованы в Docker-контейнеры. Контейнеризация позволяет изолировать приложение от операционной системы хоста, обеспечить воспроизводимость сборки и упростить масштабирование.

Были созданы следующие Docker-образы:
- образ серверной части API на базе Python 3.11 и FastAPI;
- образ Telegram-бота на базе Python 3.11 и aiogram 3;
- используется официальный образ PostgreSQL 15 для базы данных;
- используется официальный образ Redis 7 для кэширования сессий.

Собранные образы публикуются в GitHub Container Registry (GHCR), что обеспечивает интеграцию с системой контроля версий и автоматизацию процесса сборки.

#### 4.3.2 Непрерывная интеграция (CI)

Для автоматизации процесса сборки и тестирования используется GitHub Actions. При каждом изменении исходного кода в основной ветке репозитория автоматически запускаются следующие этапы:
- проверка синтаксиса и форматирования кода с использованием линтера Ruff;
- сборка Docker-образа с присвоением уникального тега на основе хеша коммита;
- публикация образа в реестр контейнеров GHCR.

Такой подход позволяет обнаруживать ошибки на ранних этапах разработки и гарантирует, что в продуктивную среду попадает только проверенный код.

#### 4.3.3 Оркестрация контейнеров

Для управления контейнерами в продуктивной среде используется Kubernetes в реализации k3s — облегчённой версии Kubernetes, оптимизированной для работы на серверах с ограниченными ресурсами.

Конфигурация развёртывания описана в виде декларативных YAML-манифестов, включающих:
- Namespace — изолированное пространство имён для ресурсов приложения;
- Deployment — описание желаемого состояния подов с указанием образа, ресурсов и переменных окружения;
- Service — абстракция для сетевого доступа к подам внутри кластера;
- PersistentVolumeClaim — запрос на выделение постоянного хранилища для базы данных;
- Secret — защищённое хранение конфиденциальных данных.

#### 4.3.4 Непрерывная доставка (CD) и GitOps

Развёртывание в кластер Kubernetes осуществляется по методологии GitOps с использованием ArgoCD. Данный инструмент отслеживает изменения в Git-репозитории с манифестами и автоматически синхронизирует состояние кластера с описанной конфигурацией.

Преимущества подхода GitOps:
- вся конфигурация инфраструктуры хранится в системе контроля версий;
- изменения проходят через процесс код-ревью перед применением;
- обеспечивается аудит всех изменений инфраструктуры;
- возможен откат к предыдущей версии конфигурации.

Для автоматического обновления образов при появлении новых версий используется Keel.sh. Данный компонент отслеживает реестр контейнеров и при обнаружении нового образа автоматически обновляет соответствующий Deployment в кластере.

#### 4.3.5 Сетевая инфраструктура

Маршрутизация входящего трафика к приложению реализована с использованием следующих компонентов:
- Cloudflare — обеспечивает DNS-управление, защиту от DDoS-атак и терминацию TLS-соединений;
- Traefik Ingress Controller — принимает входящий HTTPS-трафик и маршрутизирует его к соответствующим сервисам кластера;
- Istio Service Mesh — обеспечивает управление трафиком внутри кластера, взаимную аутентификацию сервисов (mTLS) и мониторинг.

Приложение доступно по защищённому протоколу HTTPS по адресу https://hydrocalc.prdxso.dev. Документация API в формате OpenAPI (Swagger) доступна по адресу https://hydrocalc.prdxso.dev/docs.

#### 4.3.6 Схема развёртывания

На рисунке N представлена схема взаимодействия компонентов инфраструктуры развёртывания.

```
[Вставить рисунок со схемой]
```

Рисунок N — Схема инфраструктуры развёртывания серверной части

---

## Раздел: Развёртывание веб-приложения (для добавления в раздел 6)

---

### 6.N Развёртывание веб-приложения

Веб-приложение «HydroCalc» развёрнуто на платформе GitHub Pages, которая предоставляет бесплатный статический хостинг для проектов с открытым исходным кодом.

#### Особенности развёртывания SPA-приложения

Поскольку веб-приложение реализовано как одностраничное приложение (Single Page Application, SPA) с использованием React Router, потребовалась дополнительная конфигурация для корректной работы клиентской маршрутизации:
- настроен базовый путь приложения в конфигурации сборщика Vite;
- добавлен файл 404.html с JavaScript-редиректом для обработки прямых переходов по внутренним маршрутам;
- BrowserRouter настроен с учётом базового пути развёртывания.

#### Процесс автоматического развёртывания

При внесении изменений в исходный код веб-приложения автоматически запускается GitHub Actions workflow, выполняющий следующие этапы:
- установка зависимостей проекта через npm;
- сборка оптимизированной версии приложения для продуктивной среды;
- публикация собранных статических файлов на GitHub Pages.

Веб-приложение доступно по адресу https://klimsani4.github.io/hydrocalc/.

#### Интеграция с серверной частью

Взаимодействие веб-приложения с серверной частью осуществляется посредством REST API. URL серверной части передаётся в приложение через переменные окружения на этапе сборки, что позволяет использовать различные серверы для разработки и продуктивной среды.

---

## Раздел: Развёртывание Telegram-бота (для добавления в раздел 7)

---

### 7.N Развёртывание Telegram-бота

Telegram-бот «HydroCalc» развёрнут в том же кластере Kubernetes, что и серверная часть приложения. Такой подход обеспечивает единообразие инфраструктуры и упрощает управление всеми компонентами системы.

#### Конфигурация развёртывания

Бот запускается в отдельном поде Kubernetes и взаимодействует с серверной частью через внутреннюю сеть кластера. Токен бота хранится в Kubernetes Secret, что обеспечивает безопасность конфиденциальных данных.

Для обеспечения отказоустойчивости и автоматического перезапуска при сбоях используются механизмы Kubernetes:
- автоматический перезапуск пода при его падении;
- проверки работоспособности (health checks);
- ограничение ресурсов для предотвращения влияния на другие сервисы.

#### Взаимодействие с Telegram API

Бот использует метод long polling для получения обновлений от Telegram API. Данный метод не требует публичного IP-адреса или настройки вебхуков, что упрощает развёртывание.

Telegram-бот доступен по имени пользователя @hyrdocaltbot.

---

## Раздел для Заключения (дополнение)

---

В ходе выполнения курсового проекта было успешно реализовано развёртывание всех компонентов приложения «HydroCalc» в продуктивной среде:
- серверная часть и база данных развёрнуты в кластере Kubernetes с использованием GitOps-подхода;
- веб-приложение развёрнуто на платформе GitHub Pages;
- Telegram-бот развёрнут в том же кластере Kubernetes.

Применение современных практик DevOps, таких как контейнеризация, непрерывная интеграция и доставка, а также декларативное управление инфраструктурой, позволило автоматизировать процесс развёртывания и обеспечить его воспроизводимость.

Ссылки на развёрнутое приложение:
- веб-приложение: https://klimsani4.github.io/hydrocalc/
- API-документация: https://hydrocalc.prdxso.dev/docs
- Telegram-бот: @hyrdocaltbot
